<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>The Terminal - Hacking Manual</title>
    <link rel="stylesheet" type="text/css" href="manual.css">
</head>
<body>
<div id='manual'>
<div class='section'>
<h1>The Terminal - Hacking Manual</h1>

<h2>Overview</h2>

<p> The terminal is a local multiplayer hacking game inspired by
<a href="http://keeptalkinggame.com">"Keep Talking and Nobody Explodes"</a>.
The aim of the game is to hack into a computer terminal by following the
instructions in the hacking manual, before the system locks you out.</p>

<p>Only one person can see and interact with the computer, but is not allowed to
view the hacking manual. The other players can view the manual, but are not
allowed to see the computer. The two groups must communicate with each other
in order to gain access before timer runs out.</p>

<h2>Getting started</h2>

TODO

<a name='hacking'><h2>Hacking</h2></a>
<ul>
    <li><a href='#passwords'>Guessing Passwords</a></li>
    <li><a href='#visualpasswords'>Guessing Visual Passwords</a></li>
    <li><a href='#cracking'>Cracking Programs</a></li>
    <li><a href='#decrypting'>Decrypting Filesystems</a></li>
    <li><a href='#hardware'>Disabling Hardware Security</a></li>
    <li><a href='#network'>Network Management</a></li>
    <li><a href='#minehunt'>Minehunt</a></li>
</div>

<div class='section puzzle-section'>
<a name='passwords'><h3>Guessing Passwords</h3></a>
<p class='intro'>We have recovered a shredded list of passwords from a nearby
dumpster. Despite our best efforts to piece it back together, it is still hard
to make out the passwords. Below are our best guesses for the passwords of each
user - perhaps with a bit of extra work you can work which are correct?</p>

<p>You will have a number of attempts to log in before the password is reset.
Using our cracked login program, you will be able to see how many characters
were correct - the right letter in the right position - for each attempt. You
should be able to work out the password using this information.</p>

<p>Inputting the incorrect password too many times will lead to a password
reset, and you'll have to start again.</p>

<table>
    <tr><th>User</th><th>Possible Passwords</th></tr>
    <tr>
        <td>root</td>
        <td>flask, great, force, gleam, brick, flute, blast, feast, flick,
            flank</td>
    </tr>
    <tr>
        <td>ro0t</td>
        <td>tusks, blush, askew, train, asset, burns, tries, turns, basks,
            busks</td>
    </tr>
    <tr>
        <td>rewt</td>
        <td>maple, pearl, lapel, myths, cycle, apple, ladle, ample, maize,
            capel</td>
    </tr>
    <tr>
        <td>00142331</td>
        <td>trice, racer, tours, glaze, trail, raise, slick, track, grace,
            trace</td>
    </tr>
    <tr>
        <td>00143231</td>
        <td>court, truce, fords, flirt, cruel, craft, tours, chart, fours,
            count</td> 
    </tr>
    <tr>
        <td>01043231</td>
        <td>eagle, ariel, glare, gains, earns, gauge, angle, early, agile,
            engle</td>
    </tr>
</table>
<a href='#hacking'>Back to top</a>
</div>

<div class='section puzzle-section'>
<a name='visualpasswords'><h3>Guessing Visual Passwords</h3></a>
<p class='intro'>Some organisations use a visual password system. Users select
images to identify themselves, and this selection is then used for
authentication. Fortunately for us, people usually pick images based on the
things that they like...</p>

<p>The visual login process will present you with four images - three from the
user's selected images, and one which was not selected by the user. Use the
table below to identify the user based on the images you are presented with,
and select the three correct images</p>

<p>Selecting an incorrect image will result in a temporary lockout.</p>

<table>
    <tr><th>User</th><th>Likes</th></tr>
    <tr>
        <td>User A</td>
        <td>Cars, Cats, Dogs, Planes, Music, Flowers</td>
    </tr>
    <tr>
        <td>User B</td>
        <td>Skateboarding, Horses, Music, Dogs, Food, Wine</td>
    </tr>
    <tr>
        <td>User C</td>
        <td>Books, Computers, Cats, Archery, Boats, Cars</td>
    </tr>
    <tr>
        <td>User D</td>
        <td>Soccer, Basketball, Baseball, Archery, Skateboarding, Tennis</td>
    </tr>
    <tr>
        <td>User E</td>
        <td>Books, Wine, Planes, Computers, Music, Horses</td>
    </tr>
    <tr>
        <td>User F</td>
        <td>Soccer, Tennis, Flowers, Cats, Boats, Archery</td>
    </tr>
    <tr>
        <td>User G</td>
        <td>Food, Wine, Beer, Planes, Basketball, Baseball</td>
    </tr>
    <tr>
        <td>User H</td>
        <td>Cars, Beer, Soccer, Tennis, Food, Computers</td>
    </tr>
</table>
<a href='#hacking'>Back to top</a>
</div>

<div class='section puzzle-section'>
<a name='cracking'><h3>Cracking Programs</h3></a>
<p class='intro'>You'll sometimes need to modify the code of programs on the
computer you're attempting to gain access to in order to bypass security
checks. Brush off your programming skills and open your hex editor...</p>

<p>A program is made up of a number of lines of code, where each line consists
of 6 numbers. A hex editor will allow you to modify the lines of code
one-by-one, replacing one value in the line with another value. Follow the
rules below in order to determine the correct actions for each line:</p>

<p>If you don't follow the instructions below carefully, the system will detect
your attempts to modify the program, and revert it to its original state.</p>

<ol type="a">
    <li>If this is the first line in the program go to (d), else go to (b)</li>
    <li>If this is the last line go to (j), else go to (c)</li>
    <li>If you made a change to the previous line, go to (g), else go to
        (d)</li>
    <li>If the has one or more 9s, replace the last number in the line by 7,
        else go to (e)</li>
    <li>If the line contains one or more zeros, replace the first occurence
        with 9, else go to (f)</li>
    <li>If the line contains more than 3 odd numbers, reduce the first odd
        number by 1, else go to (x)</li>
    <li>If the line has one or more zeros, replace the first number in the
        line with the number that was replaced in the previous line, else go
        to (h)</li>
    <li>If the line contains one or more 9s, replace the first occurence with
        the number of the column in the last line which was edited, else go to
        (i)</li>
    <li>If the line contains one or more values which match the value inserted
        in the previous line, replace the first occurence with zero, else go
        to (x)</li>
    <li>Replace the final value with the number of lines (excluding this line)
        which have been modified.</li>
    <li>Do not edit the line.</li>
</ol>
<a href='#hacking'>Back to top</a>
</div>

<div class='section puzzle-section'>
<a name='decrypting'><h3>Decrypting Filesystems</h3></a>
<p class='intro'>Some systems you encounter will have encrypted filesystems,
which will need to be unencrypted before you can progress further with a hack.
A disgruntled employee at one of the big security firms leaked some of the
encryption keys, which should allow you to progress</p>

<p>Our decryption program will present you with a section of encrypted data.
Use the table below to enter the correct plain-text data - decryption can then
take place based on this information.</p>

<p>Entering the incorrect key will cause data corruption, and recovering from
this will waste valuable time.</p>

<img src="decrypt.png">
<a href='#hacking'>Back to top</a>
</div>
       
<div class='section puzzle-section'>
<a name='hardware'><h3>Disabling Hardware Security</h3></a>
<p class='intro'>Some of our target devices have hardware security support in
the form of on-board expansion chips. These will prevent us from gaining access 
unless we can somehow disable them. Luckily we were able to 'obtain' a copy of
the hardware specifications, which should help you bypass this protection.</p>

<p>Each system may have one or more security chip on its motherboard, with an
associated pull-down resistor. In order to bypass the security system, you
must remove the chip, its pull-down resistor, or both, based on the information
in the below tables.</p>

<p>Booting the system with an incorrect hardware configuration may affect the
system clock, which may reduce the amount of time you have before you are
logged out.</p>

<p>Table 1:
Use the last character of the security chip's identifier and the value of the
chip's pull-down resistor to determine the correction action.</p>

<table>
    <tr>
        <th>Resistor Value</th>
        <th>Odd number</th>
        <th>Event number</th>
        <th>Zero</th>
        <th>Letter</th>
    </tr>
    <tr><td>10 kOhms</td><td>N</td><td>C</td><td>R</td><td>B</td></tr>
    <tr><td>20 kOhms</td><td>C</td><td>C</td><td>B</td><td>R</td></tr>
    <tr><td>30 kOhms</td><td>R</td><td>R</td><td>C</td><td>C</td></tr>
    <tr><td>40 kOhms</td><td>B</td><td>N</td><td>R</td><td>C</td></tr>
    <tr><td>50 kOhms</td><td>T2, row 1</td><td>T2, row 4</td><td>N></td><td>T2,
            row 3</td></tr>
    <tr><td>60 kOhms</td><td>T2, row 5</td><td>C</td><td>T2, row 2</td><td>T2,
            row 6</td></tr>
</table>

<p>Key:
<ul>
    <li>N: remove nothing.</li>
    <li>C: remove the chip.</li>
    <li>R: remove the resistor.</li>
    <li>B: remove both.</li>
    <li>T2, row#: Consult table 2, looking at the specified row.</li>
</ul>
</p>

<p>Table 2:
Use the row given by table 1, and the first character of the terminal name to
determine the correct action.</p>

<table>
    <tr>
        <th>Row</th>
        <th>Odd number</th>
        <th>Even number</th>
        <th>Zero</th>
        <th>Letter</th>
    </tr>
    <tr><td>Row 1</td><td>C</td><td>N</td><td>R</td><td>C</td></tr>
    <tr><td>Row 2</td><td>R</td><td>C</td><td>R</td><td>C</td></tr>
    <tr><td>Row 3</td><td>R</td><td>B</td><td>C</td><td>R</td></tr>
    <tr><td>Row 4</td><td>C</td><td>R</td><td>C</td><td>R</td></tr>
    <tr><td>Row 5</td><td>N</td><td>C</td><td>R</td><td>B</td></tr>
    <tr><td>Row 6</td><td>C</td><td>C</td><td>C</td><td>R</td></tr>
</table>

<p>Key:
<ul>
    <li>N: remove nothing.</li>
    <li>C: remove the chip.</li>
    <li>R: remove the resistor.</li>
    <li>B: remove both.</li>
</ul>
</p>

<p>Table 3:
This table shows the values of the different resistors, based on the coloured
markings (read from left to right) printed on the body of the resistor.</p>

<table>
    <tr><th>Markings</th><th>Value</th></tr>
    <tr><td>red-red-yellow-green</td><td>10 kOhms</td></tr>
    <tr><td>red-black-yellow-green</td><td>20 kOhms</td></tr>
    <tr><td>yellow-blue-blue-red</td><td>30 kOhms</td></tr>
    <tr><td>red-blue-blue-yellow</td><td>40 kOhms</td></tr>
    <tr><td>green-red-blue-green</td><td>50 kOhms</td></tr>
    <tr><td>green-black-blue-green</td><td>60 kOhms</td></tr>
</table>
<a href='#hacking'>Back to top</a>
</div>

<div class='section puzzle-section'>
<a name='network'><h3>Network Management</h3></a>
<p class='intro'>Some systems obtain login information from a remote
authentication server. The easiest way around this is to reconfigure the
network so that they are connected to one of our servers instead!</p>

<p>The network manager allows you to make network connections between devices
in a network. Each device is represented as a symbol in a grid. Your goal is
to use the arrow keys to draw a path from the computer you are attempting to
hack (the source, S) to our rogue authentication server (the destination, D).
You cannot visit a node in the network grid more than once.
</p>

<p>Some networks contain gateway switches (G). When connecting the source to
the destination, you must make sure to go through all such switches on the way.
Most networks also contain firewalls (x) - our server cannot communicate
through these devices and so they must be avoided.
</p>

<p>Attempts to configure the network such that it doesn't meet the above
requirements will fail, and the network configuration will roll back to its
previous state.</p>

<p>Below are some possible network configurations you will encounter. The
source and destination devices are identified by IP addresses, which are
included with the diagram.</p>

<div class='network-diagrams'>
<div class='network-diagram'>
<span class='ip'>Src IP: 192.168.1.15</span>
<span class='ip'>Dst IP: 10.0.0.1</span>
<pre>
S . . . x x
x . . . x x
x x G x x x
. . . . G .
G . . . . .
x x x x x D
</pre>
</div>

<div class='network-diagram'>
<span class='ip'>Src IP: 192.168.1.15</span>
<span class='ip'>Dst IP: 11.0.0.1</span>
<pre>
S . . G x x
. . . . x x
. x . . x x
. . x . G .
G . . x . .
x x . . . D
</pre>
</div>

<div class='network-diagram'>
<span class='ip'>Src IP: 192.168.1.50</span>
<span class='ip'>Dst IP: 11.0.0.1</span>
<pre>
S . . G x x
. . . . . x
. x . . G x
. . x . x .
G . . . . .
x x . . . D
</pre>
</div>

<div class='network-diagram'>
<span class='ip'>Src IP: 192.168.1.100</span>
<span class='ip'>Dst IP: 12.0.0.1</span>
<pre>
. x D x x .
. x . . x .
x x x . x x
. . . . . .
. x x x x .
. . . S . G
</pre>
</div>

<div class='network-diagram'>
<span class='ip'>Src IP: 192.168.1.100</span>
<span class='ip'>Dst IP: 12.0.0.2</span>
<pre>
. x x D x .
. x . . x .
x x . x x x
. . . . . .
. x x x x .
G . S . . .
</pre>
</div>

<div class='network-diagram'>
<span class='ip'>Src IP: 10.10.10.11</span>
<span class='ip'>Dst IP: 10.10.10.7</span>
<pre>
D . . . x x
. x x . x x
. x x G x x
. . . . . x
x . x x . x
x G . . . S
</pre>
</div>
</div>
<a href='#hacking'>Back to top</a>
</div>

<div class='section puzzle-section'>
<a name='minehunt'><h3>Minehunt</h3></a>
<p class='intro'>Some of the systems have limited local access permissions,
which severely harms our ability to hack into the terminal. Fortunately we
have discovered that these machines often have a buggy minehunt game installed
that we can exploit to cause some memory corruption, tricking the system to
give us elevated access permissions</p>

<p>The minehunt game is clone of a well known game where the aim is to clear all
the squares not containing mines (using left click), and placing flags on
squares that contain mines (using right click).
</p>

<p>Depending on the board layout, we can trigger a crash with 1 of 2 methods:
<ul>
    <li>Completing the game, placing the last flag when a certain multiple of
    seconds are remaining on the clock.</li>
    <li>Completing the game, deliberately click the last mine when the
    minehunt timer shows a multiple of x seconds (where x varies per board)</li>
</ul>
Below are all the possible solutions (grouped by board size) along with the
actions required to trigger a crash. The key is as follows:
<ul>
    <li>'o' indicates the location of a mine</li>
    <li>'x' indicates a position of a mine that should be clicked (once all
        other mines have been flagged)</li>
</ul>
</p>

<div class='minehunt-diagrams'>
<h4>8 rows by 10 cols</h4>
<div class='minehunt-diagram'>
<span class='time'>End with multiple of <b>3</b> secs:</span>
<pre>
. . . . . o . . . .
o . . . . . . . . .
. . . . . . . . . o
. . . o . . . . . .
. . . . . . . . . .
o o . . . . . o . .
. . . . . . . . . .
. . . . . . . . o .
</pre>
</div>
<div class='minehunt-diagram'>
<span class='time'>End with multiple of <b>3</b> secs:</span>
<pre>
. . . . . o . . . .
o o . . . . . . . .
. . . . . . . . . .
. . . o . . . . . .
. . . . . . . . o .
o o . . . . . . x .
. . . . . . . . . .
. . . . . . . . . .
</pre>
</div>
<div class='minehunt-diagram'>
<span class='time'>End with any time.</span>
<pre>
. o . . . o . . . .
o o . . . . . . . .
. . . . . . o . . .
. . . o . . . . . .
. . . . . . . . . .
o x . . . . . . o .
. . . . . . . . . .
. o . . o . . . . .
</pre>
</div>
<h4>8 rows by 9 cols</h4>
<div class='minehunt-diagram'>
<span class='time'>End with multiple of <b>3</b> secs:</span>
<pre>
o . . . . o . . .
. . . . . . . . .
. . . . . . . . .
. . . o . . . . .
. . . . . . . . .
o o . . . . . o .
. . . . . . . . .
. . . . . . . . o
</pre>
</div>
<div class='minehunt-diagram'>
<span class='time'>End with multiple of <b>5</b> secs:</span>
<pre>
o . . . . o . . .
o . . . . . . . .
. . . . . . . x .
. . . o . . . . .
. . . . . . . . .
o o . . . . . o .
. . . . . . . . .
. o . . . . . . o
</pre>
</div>
<div class='minehunt-diagram'>
<span class='time'>End with multiple of <b>6</b> secs:</span>
<pre>
o . . . . o . . . 
. . . . . . . . . 
. . . . . . . . . 
. . . o . . . . . 
. . . . . . . . . 
o o . . . . . o . 
o o . . . . . . . 
. . . . . . . . o 
</pre>
</div>
</div>
<a href='#hacking'>Back to top</a>
</div>

<script>
    "use strict";

    String.prototype.replaceAll = function(search, replacement) {
            var target = this;
                return target.split(search).join(replacement);
    };


    var networks = document.querySelectorAll('.network-diagram pre');
    for (var network of networks) {
        var diagram = network.innerHTML;
        diagram = diagram.replaceAll("x", "<span class=firewall>x</span>");
        diagram = diagram.replaceAll("G", "<span class=gateway>G</span>");
        diagram = diagram.replaceAll("S", "<span class=src>S</span>");
        diagram = diagram.replaceAll("D", "<span class=dst>D</span>");
        diagram = diagram.replaceAll(".", "<span class=node>.</span>");
        network.innerHTML = diagram;
    }

    var boards = document.querySelectorAll('.minehunt-diagram pre');
    for (var board of boards) {
        var diagram = board.innerHTML;
        diagram = diagram.replaceAll("x", "<span class=finish>x</span>");
        diagram = diagram.replaceAll("o", "<span class=bomb>o</span>");
        diagram = diagram.replaceAll(".", "<span class=empty>.</span>");
        board.innerHTML = diagram;
    }
</script>
</body>
</html>
